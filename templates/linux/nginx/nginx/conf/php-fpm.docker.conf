;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; Main PHP-FPM configuration (single-file, with one pool: [www])
; This file is used by:
;   ./nginx/php/bin/php-fpm -y ./nginx/php/etc/php-fpm.conf
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

[global]
; PID file location (used also by your start.sh script)
pid = ../../logs/php-fpm.pid

; Error log file
error_log = /opt/app/nginx/logs/php-fpm-error.log

; Log level: alert, error, warning, notice, debug
log_level = notice


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; POOL DEFINITION - REQUIRED
; At least ONE pool section like [www] must exist, or PHP-FPM will fail.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

[www]

; ==========================================================
; Listening address - must match nginx fastcgi_pass
; ==========================================================
; If your nginx.conf has:
;     upstream php_farm { server 127.0.0.1:9000; }
; then this must be:
listen = 127.0.0.1:9000

; Allow only local connections (nginx on same machine)
listen.allowed_clients = 127.0.0.1

; ==========================================================
; User and group
; ==========================================================
; Use a valid user on your system (www-data, nobody, etc.)
; On many Linux systems, www-data is a common web user.
user  = www-data
group = www-data

; If www-data does not exist, you can fall back to:
; user  = nobody
; group = nobody

; ==========================================================
; Process manager (equivalent to your php-cgi settings)
; ==========================================================
; You were using:
;   PHP_FCGI_CHILDREN=8
;   PHP_FCGI_MAX_REQUESTS=1000
; So we map that to:
;   pm.max_children = 8
;   pm.max_requests = 1000

pm = dynamic
pm.max_children = 8
pm.start_servers = 2
pm.min_spare_servers = 2
pm.max_spare_servers = 4
pm.max_requests = 1000

; ==========================================================
; Logging (optional but useful)
; ==========================================================
access.log = ../logs/php-fpm-access.log

; Log requests that are too slow
slowlog = ../logs/php-fpm-slow.log
request_slowlog_timeout = 5s

; ==========================================================
; Security
; ==========================================================
; Limit which file extensions are treated as PHP
;security.limit_extensions = .php .php3 .php4 .php5 .php7 .phtml

; ==========================================================
; Extra PHP values (optional)
; ==========================================================
;php_admin_value[error_log] = ../../logs/php-errors.log
;php_admin_flag[log_errors] = on
